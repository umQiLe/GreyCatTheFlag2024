## All About Timing

### Introduction:
This write-up explores the exploitation of a vulnerability in a server-side application that relies on a pseudo-random number generator (PRNG) seeded with the current time.

### Vulnerability:
The vulnerability arises from the use of the current time as the seed for the PRNG. Since the seed is predictable based on the current system time, an attacker can predict the sequence of random numbers generated by the PRNG.

### Exploitation:
The provided Python script demonstrates how an attacker can exploit this vulnerability. Since the PRNG is seeded with the current time, we just have to seed our PRNG with the current time and connect to the server and call random.randint.

### Proof of Concept:
1. The Python script seeds the PRNG with the current time and generates a random number within a specific range.
2. The script then establishes a connection to the vulnerable server and sends the generated random number.
3. Upon receiving the server's response, the script prints the data received.

### Conclusion:
By leveraging the predictability of the PRNG seed, an attacker can manipulate the server's behavior and potentially exploit other vulnerabilities present in the application.

```
import time
import random
import socket

random.seed(int(time.time()))

n = random.randint(1000000000000000, 10000000000000000 - 1)

# Send the number to the client via socket
# nc challs.nusgreyhats.org 31111

HOST = "challs.nusgreyhats.org"
PORT = 31111

with socket.socket(socket.AF_INET, socket.SOCK_STREAM) as s:
    s.connect((HOST, PORT))
    data = s.recv(1024)
    s.sendall(f"{n}\n".encode())
    data = s.recv(1024)


print("Received", repr(data))
```
